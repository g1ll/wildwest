$(document).ready(canvasApp);function canvasApp(){var aJ=document.getElementById("canvas");var ak=aJ.getContext("2d");var aD;var ap;var aB;var f;var Y;var aF;var aq;var j=[];var l=[];var V;var aA=[];var aC=[];var aj=[];var s;var k=25;var aa=25;var at=[];var aI=[];var ab;var L;var X;var ah;var ad;var n;var N;var ai;var e=0;var g=21;var P=0;var K=60;var an=setInterval(aH,K);var F;var q;var H;var Q="sounds/intro.mp3";var W;var C="sounds/theme.mp3";var B;var z="sounds/punch.mp3";var p;var y="sounds/380.mp3";var ax;var w="sounds/pain.mp3";var o;var u="sounds/yahoo.mp3";var S;var ae="sounds/end.mp3";var aG;var M;var a;var t;var T;var af;var aE;var R;var ay;var av;var au;var aw;var ao;var x;var G=0;var r="down";var E="stop";O();function ag(){e=0;aD=aJ.width/2;ap=aJ.height/2;aB=20;f=4;Y=3;aF=0;aq=aJ.height/2-Y/2;L=0;X=0;ah=false;ad=0;n=false;N=23150;ai=0;K=60;F=20;q=30;G=0;r="down";E="stop";V=20;j=[];l=[];for(var d=0;d<V;d++){j.push(Math.round(Math.random()*aJ.height-50));l.push(Math.round(Math.random()*aJ.width-50))}s=50+Math.round(Math.random()*50);aA=[];aA=[];aj=[];for(var d=0;d<s;d++){aA.push(Math.round(Math.random()*aJ.height-50));aC.push(Math.round(Math.random()*aJ.width-50));aj.push(Math.round(Math.random()))}ab=1;at=[];aI=[];for(var d=0;d<ab;d++){at.push(30+Math.round(Math.random()*(aJ.height-aa-30)));aI.push(Math.round(Math.random()*(aJ.width-k)))}H.pause();H.currentTime=0;S.pause();if(typeof S.loop==="boolean"){S.loop=false}else{S.removeEventListener("ended",function(){this.currentTime=0},false)}S.currentTime=0;W.volume=1;W.play();clearInterval(an);an=setInterval(m,K);p.currentTime=0;p.play()}function m(){Z();U();A();if(!n){I();c();if(E==="walk"){ac()}if(h(aF,aq,f,Y,aD,ap,aB)){ax.play();B.play();W.pause();W.currentTime=0;S.currentTime=0;S.volume=0.5;S.play();if(typeof S.loop==="boolean"){S.loop=true}else{S.addEventListener("ended",function(){this.currentTime=0},false)}n=true;E="dead";r==="fall";setTimeout(function(){clearInterval(an)},300)}if(al()){N+=50}if(!ah){ar("Controle o cowboy com as teclas A B C D ! Fuja dos tiros !!!","rgba(0,0,0,.5)",36)}}b()}function ac(){if(aD<=aJ.width-aB+1&&aD>=0){if(r==="right"){aD+=F;ah=true}else{if(r==="left"){aD-=F;ah=true}}}if(ap<=aJ.height-aB+1&&ap>=0){if(r==="up"){ap-=F;ah=true}else{if(r==="down"){ap+=F;ah=true}}}if(aD>(aJ.width-aB+1)){aD=aJ.width-aB+1}else{if(aD-aB+1<0){aD=aB+1}}if(ap>(aJ.height-aB+1)){ap=aJ.height-aB+1}else{if(ap-aB+1<0){ap=aB+1}}}function I(){if(ah){if(aq>aJ.height||aF>aJ.width){ai++;p.currentTime=0;p.play();L=Math.round(Math.random());X=Math.round(Math.random());aF=0;aq=0;if(L){aF=aD;if(X){aF=Math.random()*aJ.width-50}}else{aq=ap;if(X){aq=Math.random()*aJ.height-50}}}if(L){aq+=q;if(X){aF+=q/2}}else{aF+=q;if(X){aq+=q/2}}}else{aF+=q}}function h(v,aQ,aM,aN,d,aP,aK){var aR=v-aK;var aO=aQ-aK;var aS=aM+aK*2;var aL=aN+aK*2;if((d>=aR&&d<=aR+aS)&&((aP>=aO&&aP<=aO+aL))){return true}else{return false}}function aH(){H.play();var d=Math.round(((e*100)/g));if(P<1){P+=0.1}else{P=0}if(e>=g){d=100;P=1;am();ak.fillStyle="rgba(255,255,255,1)";ak.fillRect(0,0,aJ.width,aJ.height);ar("READY "+d+"%  !!!",aJ.height/2-70,"rgba(0,0,0,"+P+")","bold",24,"west");ar("Move the CowBoy with keys up, down, left and right  (←↑→↓) ",aJ.height/2+50,"rgba(0,0,0,"+P+")","bold",24,"west");ar("to capture the money bag and scape of the shots! ",aJ.height/2+75,"rgba(0,0,0,"+P+")","bold",24,"west");ak.globalAlpha=d/100;ak.drawImage(ao,0,0,48,70,aJ.width/2-24,aJ.height/2-35,48,70);ak.globalAlpha=1}else{ak.fillStyle="rgba(255,255,255,1)";ak.fillRect(0,0,aJ.width,aJ.height);ar("Carregando... "+d+"% ",aJ.height/2-70,"rgba(0,0,0,"+P+")","bold",24,"west");ak.globalAlpha=d/100;ak.drawImage(ao,0,0,48,70,aJ.width/2-24,aJ.height/2-35,48,70);ak.globalAlpha=1}}function D(aK,d){ak.strokeStyle="red";ak.strokeRect(aD-(Math.round(Math.random()*d)),ap-(Math.round(Math.random()*d)),1,1);ak.strokeRect(aD+(Math.round(Math.random()*d)),ap+(Math.round(Math.random()*d)),1,1);ak.strokeRect(aD-(Math.round(Math.random()*d)),ap+(Math.round(Math.random()*d)),1,1);ak.strokeRect(aD+(Math.round(Math.random()*d)),ap-(Math.round(Math.random()*d)),1,1);for(var v=0;v<aK;v++){ak.beginPath();ak.fillStyle="rgba(255,0,0,"+(Math.random()+0.5)+")";ak.arc(aD+((Math.round(Math.random()))?+(Math.round(Math.random()*d)):-(Math.round(Math.random()*d))),ap+((Math.round(Math.random()))?+(Math.round(Math.random()*d)):-(Math.round(Math.random()*d))),(Math.round(Math.random()*2)),(Math.PI/180)*0,(Math.PI/180)*180,false);ak.fill();ak.closePath()}}function Z(){ak.fillStyle=ak.createPattern(af,"repeat");ak.fillRect(0,0,aJ.width,aJ.height);for(var d=0;d<V;d++){ak.drawImage(aE,l[d],j[d],50,50)}for(var d=0;d<s;d++){ak.drawImage(ay,197*aj[d],0,197,195,aC[d],aA[d],50,50)}ak.strokeStyle="#000000";ak.strokeRect(0,0,aJ.width,aJ.height)}function c(){var d=752;var v=658;if(X){J(T,0,0,d,v,aF,aq,f*5,Y*5,45)}else{if(L){J(T,0,0,d,v,aF,aq,f*5,Y*5,90)}else{ak.drawImage(T,aF-12,aq-12,f*5,Y*5)}}}function A(){if(E==="walk"){G++;if(G>1&&(r=="right"||r=="left")){G=0}else{if(G>2){G=0}}}else{if(E==="dead"){r="fall";G++;if(G>5){G=5}}else{G=0}}if(r==="right"){ak.drawImage(av,48*G,0,48,70,aD-24,ap-35,48,70)}else{if(r==="left"){ak.drawImage(au,48*G,0,48,70,aD-24,ap-35,48,70)}else{if(r==="up"){ak.drawImage(aw,48*G,0,48,70,aD-24,ap-35,48,70)}else{if(r==="down"){ak.drawImage(ao,48*G,0,48,70,aD-24,ap-35,48,70)}else{if(r==="fall"){ak.drawImage(x,48*G,0,48,70,aD-24,ap-35,48,70);if(G<5){D(10*G,5*G);D(10*G,10*G);D(20*G,5*G)}else{D(10*G,5*G);D(10*G,10*G);D(20*G,5*G)}}}}}}}function U(){for(var d=0;d<ab;d++){ak.drawImage(a,aI[d],at[d],k,aa)}}function al(){for(var d=0;d<ab;d++){if(h(aI[d],at[d],k,aa,aD,ap,aB)){i(d);return true}}}function i(d){at[d]=Math.round(30+Math.round(Math.random()*(aJ.height-aa-30)));aI[d]=Math.round(Math.random()*(aJ.width-k))}function b(){ak.fillStyle=ak.createPattern(R,"repeat");ak.fillRect(0,0,aJ.width,30);var aS="";var aQ=aJ.width/2;var d=0;if(N>0){aS=" k"}var aK="Money: $ "+N+aS;ar(aK,d+5,"#eee8a3","normal",24,"west");aQ=aQ+ak.measureText(aK).width/2+2;for(var aU=0,aP=Math.floor(N/9600);aU<aP;aU++){ak.drawImage(aG,0,0,80,80,aQ+aU*k,d,k+k/2,aa+aa/4)}for(var aT=0,aL=Math.floor((N-aP*9600)/1200);aT<aL;aT++,aU++){ak.drawImage(M,224,0,224,175,aQ+aU*k,d,k+k/2,aa+aa/4)}for(var aN=0,aV=Math.floor((N-(aL*1200)-(aP*9600))/600);aN<aV;aN++,aU++){ak.drawImage(M,0,0,224,175,aQ+aU*k,d,k+k/2,aa+aa/4)}for(var aM=0,aR=Math.floor((N-(aV*600)-(aL*1200)-(aP*9600))/150);aM<aR;aM++,aU++){ak.drawImage(t,aQ+aU*k,d,k+k/2,aa+aa/4)}for(var aO=0,v=Math.floor((N-aR*150-(aV*600)-(aL*1200)-(aP*9600))/50);aO<v;aO++,aU++){ak.drawImage(a,aQ+aU*k,d+5,k,aa)}}function J(aO,aM,aL,aN,d,aQ,aP,v,aR,aK){ak.save();ak.beginPath();ak.translate(aQ+v/2,aP+aR/2);ak.rotate(aK*Math.PI/180);ak.drawImage(aO,aM,aL,aN,d,-v/2,-aR/2,v,aR);ak.restore()}function am(){$(window).keydown(function(d){ad=d.which;if(!n){if(ad===68||ad===39){E="walk";r="right"}else{if(ad===65||ad===37){E="walk";r="left"}else{if(ad===87||ad===38){E="walk";r="up"}else{if(ad===83||ad===40){E="walk";r="down"}}}}if(ad===32&&e===g){H.pause();H.currentTime=0;setTimeout(ag,300)}}else{r==="fall";if(ad===32){clearInterval(an);W.pause();W.currentTime=0;setTimeout(ag,300)}}});$(window).keyup(function(d){if(!n){E="stop"}})}function ar(aP,aL,aO,d,aQ,aK){ak.font=d+" "+aQ+"px "+aK;ak.fillStyle=aO;ak.textBaseline="top";var aN=ak.measureText(aP);var aM=aN.width;var v=(aJ.width/2)-(aM/2);ak.fillText(aP,v,aL)}function az(aO,aL,aN,aK,v,d,aM){ak.font=aK+" "+v+"px "+d;ak.fillStyle=aM;ak.textBaseline="top";ak.fillText(aO,aL,aN)}function O(){W=new Audio(C);W.load();W.volume=1;if(typeof W.loop==="boolean"){W.loop=true}else{W.addEventListener("ended",function(){this.currentTime=0},false)}W.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);B=new Audio(z);B.load();B.volume=0.5;B.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);p=new Audio(y);p.load();p.volume=0.3;p.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);ax=new Audio(w);ax.load();ax.volume=0.5;ax.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);o=new Audio(u);o.load();o.volume=1;o.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);H=new Audio(Q);H.load();H.volume=1;H.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);S=new Audio(ae);S.load();S.volume=1;S.addEventListener("canplaythrough",function(){e++;this.oncanplaythrough=null},false);av=new Image();av.src="img/sprites/cb_d.png";av.addEventListener("load",function(){e++},false);au=new Image();au.src="img/sprites/cb_e.png";au.addEventListener("load",function(){e++},false);aw=new Image();aw.src="img/sprites/cb_up.png";aw.addEventListener("load",function(){e++},false);ao=new Image();ao.src="img/sprites/cb_dw.png";ao.addEventListener("load",function(){e++},false);af=new Image();af.src="img/dust.png";af.addEventListener("load",function(){e++},false);aE=new Image();aE.src="img/rocks.png";aE.addEventListener("load",function(){e++});ay=new Image();ay.src="img/sprites/grass.png";ay.addEventListener("load",function(){e++});T=new Image();T.src="img/bullet4.png";T.addEventListener("load",function(){e++});a=new Image();a.src="img/moneybag2.png";a.addEventListener("load",function(){e++});t=new Image();t.src="img/moneybag3.png";t.addEventListener("load",function(){e++});M=new Image();M.src="img/sprites/silvergold.png";M.addEventListener("load",function(){e++});x=new Image();x.src="img/sprites/cb_dead.png";x.addEventListener("load",function(){e++});aG=new Image();aG.src="img/diamond.png";aG.addEventListener("load",function(){e++});R=new Image();R.src="img/hud.png";R.addEventListener("load",function(){e++})}};